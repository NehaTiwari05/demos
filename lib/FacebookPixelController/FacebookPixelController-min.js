"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},_createClass=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),FacebookPixelController=function(){function t(e){_classCallCheck(this,t);var o="fb-pixel-status";this.defaultOptions={optOutButtonSelector:".js-fb-opt-out",optInButtonSelector:".js-fb-opt-in",cookieName:o,localStorageKey:o,secure:!0,pixelId:"1944570812537922",fbScriptSrc:"https://connect.facebook.net/de_DE/fbevents.js"},this.options=_extends({},this.defaultOptions,e),this.$optOutButton=document.querySelector(this.options.optOutButtonSelector),this.$optInButton=document.querySelector(this.options.optInButtonSelector),this.usingStorage=t.storageAvailable(),t.setStorage=t.setStorage.bind(this),t.setCookie=t.setCookie.bind(this),t.disableTrackingFunction=t.disableTrackingFunction.bind(this),t.createTrackingScript=t.createTrackingScript.bind(this),this.addEventListeners()}return _createClass(t,[{key:"addEventListeners",value:function t(){var e=this;this.$optOutButton&&this.$optOutButton.addEventListener("click",function(t){t.preventDefault(),e.optOutController()}),this.$optInButton&&this.$optInButton.addEventListener("click",function(t){t.preventDefault(),e.optInController()})}},{key:"optOutController",value:function e(){this.usingStorage&&t.setStorage("opt-out"),t.setCookie("opt-out"),window.hasOwnProperty("fbq")&&t.disableTrackingFunction()}},{key:"optInController",value:function e(){t.setStorage("opt-in"),t.setCookie("opt-in");var o=t.createTrackingScript();document.body.appendChild(o)}},{key:"getStatus",value:function t(){if(this.usingStorage)return localStorage.getItem(this.options.localStorageKey)}},{key:"hasOptedOut",value:function t(){if(this.usingStorage)return"opt-out"===localStorage.getItem(this.options.localStorageKey)}}],[{key:"setStorage",value:function t(e){"opt-in"===e||"opt-out"===e?localStorage.setItem(this.options.localStorageKey,e):console.error("Invalid state. Use opt-in or opt-out.")}},{key:"setCookie",value:function t(e){if("opt-in"===e||"opt-out"===e){var o=this.options.secure?"secure":"",n="https:"!==location.protocol;o&&n&&console.warn("Trying to set a secure cookie in an insecure context. This wonâ€™t work."),document.cookie=this.options.cookieName+"="+e+"; expires=Fri, 30 Jan 2071 23:00:00 GMT; "+o+"; path=/"}else console.error("Invalid state to set the status cookie. Use `opt-in` or `opt-out`.")}},{key:"disableTrackingFunction",value:function t(){delete window.fbq}},{key:"createTrackingScript",value:function t(){var e=document.createElement("script");return e.innerText="!function(f,b,e,v,n,t,s)\n      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?\n      n.callMethod.apply(n,arguments):n.queue.push(arguments)};\n      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';\n      n.queue=[];t=b.createElement(e);t.async=!0;\n      t.src=v;s=b.getElementsByTagName(e)[0];\n      s.parentNode.insertBefore(t,s)}(window, document,'script',\n      '"+this.options.fbScriptSrc+"');\n      fbq('init', '"+this.options.pixelId+"');\n      fbq('track', 'PageView');",e}},{key:"storageAvailable",value:function t(){var e=localStorage,o="__storage_test__";try{return e.setItem(o,o),e.removeItem(o),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==e.length}}}]),t}();new FacebookPixelController;